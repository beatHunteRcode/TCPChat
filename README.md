# TCPChat

#### Поля

- Type - тип сообщения (первое подключение/текст/файл/etc). 2 байта
- Length - длина сообщения. 4 байта
- Time - время отправки сообщения. Заполняется сервером. 16 байт
- Username - имя автора отправляемого сообщения. 512 байт
- Text - текст отсылаемого сообщения. 4194304 байт = 1 МБ. Размер был выбран исходя из кодировки UTF-8, которая использует от 1 до 4 байт на символ.
- Attached File Name - имя отправляемого файла. 512 байт
- Attached File Data - отправляемый файл в байтовом виде. 1073741824 байт = 1 ГБ. <br>Максимальный размер отправялемого файла = 1 ГБ

Максимальный размер отправляемого пакета = 1 ГБ

##### Соединение клиента с сервером. Последовательность

1. Клиент отправляет сообщение со своим именем и ждет ответа от сервера на возможное присоединение
2. Если имя доступно, сервер разрешает клиенту присоединится
3. Клиент присоединяется и может отправлять сообщения другим клиентам

##### Отсоединение клиента от сервера. Случаи.

- С помощью ключевого слова `exit()`
- Закрыть консоль

##### Отправка сообщения

После того, как клиент ввел текст и нажал `Enter`, начинается формирование сообщения и его отправка

1. Формируются поля все вышеперечисленные поля в преобразуются в массив байт
2. Все сформированные массивы байт помещаются в поток `NetworkStream` 
3. Получившийся поток байт отправляется по сокету серверу
4. Сервер считывает поток байт из сокета, разделяет поток на массивы байт, считывая определенные промежутки
5. Получившиеся массивы байт преобразуются в класс `Message`, все данные распределяются по соответсвующим полям
6. Присланное сообщение выводится в консоль на сервере и отправляется всем другим клиентам

